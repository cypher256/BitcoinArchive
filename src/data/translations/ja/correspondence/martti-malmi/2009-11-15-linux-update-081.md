---
title: "Linuxアップデート"
date: 2009-11-15T15:40:29Z
source: correspondence
sourceUrl: "https://mmalmi.github.io/satoshi/"
author: "Satoshi Nakamoto"
participants:
  - name: "Satoshi Nakamoto"
    slug: "satoshi-nakamoto"
  - name: "Martti Malmi"
    slug: "martti-malmi"
description: "linux-0.1.6-test5がゾンビソケット問題を解決。MSG_DONTWAITが根本原因を修正。残るDB例外の問題と64ビット環境での再現性について調査協力を依頼。"
isSatoshi: true
threadId: "satoshi-martti-malmi"
threadTitle: "Satoshi ↔ Martti Malmi Correspondence"
threadPosition: 81
tags:
  - "correspondence"
  - "early-contributor"
  - "linux"
secondarySources:
  - name: "Martti Malmi's Published Email Archive"
    url: "https://mmalmi.github.io/satoshi/"
  - name: "COPA v. Wright Trial Exhibits"
    url: "https://www.opencrypto.org/2024-02-22-witnesses-satoshi-correspondence/"
translationStatus: complete
---

linux-0.1.6-test5がLibertyのゾンビソケット問題を解決しました。MSG_DONTWAITが根本原因を修正し、スレッドの終了と再起動は必要ありません。ソケットは既にノンブロッキングとしてマークされているので、なぜこうなるのか理解できません。忘れたのかもしれません。ソケットが失敗してOSが閉じたら、ノンブロッキングだったことを覚えているものは何もなくなると考えられますが、閉じたハンドルにアクセスすればすぐにエラーを返すはずです。WindowsにはMSG_DONTWAITがなく、ソケットをノンブロッキングとしてマークするのが唯一の方法なので、WineでWindows版を実行する場合はスレッドの終了に頼る必要があります。

現在の唯一の問題は彼が得ているDB例外です。
************************
EXCEPTION: 11DbException
Db::open: Bad file descriptor
bitcoin in ThreadMessageHandler()
************************
EXCEPTION: 11DbException
Db::close: Bad file descriptor
bitcoin in ThreadMessageHandler()

これはWineの問題だと予想していましたが、Linuxでも同様に出ています。datadirを別のドライブに移動しても改善しませんでした。私は一度も出たことがありません。大量のアクティビティとDBアクセスを継続的に生成するストレステストを実行していますが、出たことがありません。

彼はUbuntu 64ビットで、私は32ビットなので、それが違いだと推測しています。あなたのLinuxマシンは64ビットですか、32ビットですか？DB例外が出たことはありますか？（db.logも確認してください。）test5でゾンビ問題が修正されたので、あなたのLinuxマシンで実行を始めてもらえますか？ここで何に対処しているのか、より良く把握するために3票目が欲しいところです。DB例外はキャッチされないので、出るとプログラムが停止します。

ちなみに、Zetaboardsは「Member #」を表示することにこだわっているので、早めにサインアップして良いアカウント番号を確保した方がいいですよ。

*出典：COPA対Wright裁判の証言の一環として、2024年2月にMartti MalmiによりGitHubで公開。完全な書簡アーカイブはmmalmi.github.io/satoshi/で閲覧可能。*
