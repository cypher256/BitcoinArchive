---
title: "返信: Bitcoind"
date: 2010-03-05T00:09:02Z
source: correspondence
sourceUrl: "https://mmalmi.github.io/satoshi/"
author: "Martti Malmi"
participants:
  - name: "Satoshi Nakamoto"
    slug: "satoshi-nakamoto"
  - name: "Martti Malmi"
    slug: "martti-malmi"
description: "gdbでデバッグ中に取得した別のテストランのdebug.logを送ります。"
isSatoshi: false
threadId: "satoshi-martti-malmi"
threadTitle: "Satoshi ↔ Martti Malmi Correspondence"
threadPosition: 184
tags:
  - "correspondence"
  - "early-contributor"
  - "development"
secondarySources:
  - name: "Martti Malmi's Published Email Archive"
    url: "https://mmalmi.github.io/satoshi/"
  - name: "COPA v. Wright Trial Exhibits"
    url: "https://www.opencrypto.org/2024-02-22-witnesses-satoshi-correspondence/"
translationStatus: complete
---

gdbでデバッグ中に取得した別のテストランのdebug.logを送ります。プログラムはデバッグ行「irc 8」の後にメモリを食い始め、数秒以内に「terminate called after throwing an instance of 'std::bad_alloc'」でクラッシュしました。

> RecvUntilの中にあるようですが、まだ何が問題なのか分かりません。考えられるのは、ソケットが大量の文字を受信している場合くらいです。
>
> このirc.cppを試してみてください。debug.logが急速に大きくなる可能性があるので、すぐに終了できるよう準備しておいてください。
>
> mmalmi@cc.hut.fi wrote:
>> debug.logを添付します
>>
>>> かなり絞り込めました。debug.logにIRCの活動が何も表示されていないので、RecvUntilを通過できなかったのだと思います。目視では明らかな問題は見当たりません。ConnectSocketかRecvUntilのどちらかだと思います。
>>>
>>> 添付のirc.cppとnet.cppで試して、debug.logを送ってください。
>>>
>>> あるいは、gdbで実行してThreadIRCSeedをステップ実行することもできます
>>> gdb --args bitcoin [switches]
>>> b ThreadIRCSeed
>>> run
>>> step
>>> またはuでルーチンのステップオーバーとステップアウト。
>>>
>>> mmalmi@cc.hut.fi wrote:
>>>> getinfoに関係なくエラーが発生します。ThreadIRCSeedをコメントアウトしたところ、問題が解決しました。
>>>>
>>>>> getinfoをしなくても同じ現象が起きますか？
>>>>>
>>>>> 以下のCreateThreadsをコメントアウトして、1つずつ有効にしていけば、どのスレッドに問題があるか分かります。
>>>>>
>>>>> net.cpp, under // Start threads
>>>>>   CreateThread(ThreadIRCSeed, NULL)
>>>>>   CreateThread(ThreadSocketHandler, NULL, true)
>>>>>   CreateThread(ThreadOpenConnections, NULL)
>>>>>   CreateThread(ThreadMessageHandler, NULL)
>>>>>
>>>>> init.cpp:
>>>>>   CreateThread(ThreadRPCServer, NULL);
>>>>>
>>>>> mmalmi@cc.hut.fi wrote:
>>>>>> 送ります。クラッシュ時のエラーメッセージを伝え忘れていました：
>>>>>>
>>>>>> terminate called after throwing an instance of 'std::bad_alloc'
>>>>>> what():  std::bad_alloc
>>>>>>
>>>>>>> debug.logを送ってもらえますか？
>>>>>>>
>>>>>>> mmalmi@cc.hut.fi wrote:
>>>>>>>> dddデバッガでbitcoindのビルドをデバッグしようとしましたが、まだうまくいっていません。いつもシステムのメモリを全部使い切って最終的にクラッシュしてしまいます。最新の64ビット版bitcoindのビルドをもう一度送っていただけますか？自分のビルドの問題なのか確認したいです。
>>>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>
>>>>
>>>>
>>
>>
>>

*出典：COPA対Wright裁判の証言の一環として、2024年2月にMartti MalmiによりGitHubで公開。完全な書簡アーカイブはmmalmi.github.io/satoshi/で閲覧可能。*
