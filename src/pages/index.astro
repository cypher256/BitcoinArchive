---
import BaseLayout from '../layouts/BaseLayout.astro';
import EntryCard from '../components/EntryCard.astro';
import { useTranslations, getEntries } from '../i18n/utils';

const lang = 'en';
const t = useTranslations(lang);
const entries = await getEntries(lang);
---

<BaseLayout
  title={`${t('site.title')} - ${t('site.subtitle')}`}
  description={t('site.description')}
  lang={lang}
  alternateJa="https://cypher256.github.io/BitcoinArchive/ja/"
>
  <div class="container">
    <section class="hero">
      <h1>{t('site.title')}</h1>
      <p class="subtitle">{t('site.subtitle')}</p>
      <p class="description">{t('site.description')}</p>
    </section>

    <section class="stats">
      <div class="stat">
        <span class="stat-number">{entries.length}</span>
        <span class="stat-label">{t('nav.entries')}</span>
      </div>
      <div class="stat">
        <span class="stat-number">{new Set(entries.map(e => e.data.source)).size}</span>
        <span class="stat-label">{t('nav.sources')}</span>
      </div>
      <div class="stat">
        <span class="stat-number">{new Set(entries.flatMap(e => e.data.participants.map(p => p.slug))).size}</span>
        <span class="stat-label">{t('nav.participants')}</span>
      </div>
    </section>

    <section class="recent">
      <h2>{t('nav.entries')}</h2>
      {entries.map((entry) => (
        <EntryCard
          id={entry.id}
          title={entry.data.title}
          date={entry.data.date}
          author={entry.data.author}
          source={entry.data.source}
          description={entry.data.description}
          isSatoshi={entry.data.isSatoshi}
          lang={lang}
        />
      ))}
    </section>
  </div>
</BaseLayout>

<style>
  .hero {
    text-align: center;
    padding: 3rem 0 2rem;
    border-bottom: 1px solid var(--color-border);
    margin-bottom: 2rem;
  }
  .hero h1 {
    margin: 0;
    font-size: 2.5rem;
  }
  .subtitle {
    font-family: var(--font-heading);
    font-size: 1.2rem;
    color: var(--color-text-muted);
    margin: 0.5rem 0;
  }
  .description {
    font-size: 1rem;
    color: var(--color-text-muted);
    max-width: 600px;
    margin: 1rem auto 0;
  }
  .stats {
    display: flex;
    justify-content: center;
    gap: 3rem;
    padding: 1.5rem 0;
    border-bottom: 1px solid var(--color-border);
    margin-bottom: 2rem;
  }
  .stat {
    text-align: center;
  }
  .stat-number {
    display: block;
    font-family: var(--font-heading);
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-accent);
  }
  .stat-label {
    font-family: var(--font-heading);
    font-size: 0.85rem;
    color: var(--color-text-muted);
  }
  .recent h2 {
    margin-top: 0;
  }
</style>
